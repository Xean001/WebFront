<div class="admin-container">
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">Gesti√≥n de Horarios</h1>
      <p class="hero-subtitle">Configura tu disponibilidad y excepciones de horario</p>
    </div>
  </section>

  <!-- Admin Section -->
  <section class="admin-section">
    <div class="container">
      <!-- Tabs Navigation -->
      <div class="tabs-nav">
        <button class="tab-button" [class.active]="tabActivo === 1" (click)="cambiarTab(1)">
          <span class="tab-icon">üïê</span> Mis Horarios
        </button>
        <button class="tab-button" [class.active]="tabActivo === 2" (click)="cambiarTab(2)">
          <span class="tab-icon">‚ö†Ô∏è</span> Excepciones
        </button>
      </div>

      <!-- Tab: Horarios -->
      @if (tabActivo === 1) {
      <div class="tab-content">
        <div class="content-grid">
          <!-- Form Section -->
          <div class="form-section">
            <div class="form-container">
              <div class="form-header">
                <h2 class="form-title">Agregar Horario</h2>
              </div>
              <div class="form-body">
                <form [formGroup]="formularioHorario" (ngSubmit)="guardarHorario()" class="form-content">
                  <div class="form-group">
                    <label class="form-label">D√≠a de la Semana <span class="required">*</span></label>
                    <select class="form-select" formControlName="diaSemana">
                      <option value="">-- Seleccionar --</option>
                      <option *ngFor="let dia of dias" [value]="dia.valor">{{ dia.nombre }}</option>
                    </select>
                    @if (formularioHorario.get('diaSemana')?.touched && formularioHorario.get('diaSemana')?.invalid) {
                    <div class="error-message">Selecciona un d√≠a</div>
                    }
                  </div>

                  <div class="form-group checkbox">
                    <input type="checkbox" id="descanso" class="form-checkbox" formControlName="descanso"
                      (change)="toggleDescanso()">
                    <label class="checkbox-label" for="descanso">Es d√≠a de descanso</label>
                  </div>

                  @if (!formularioHorario.get('descanso')?.value) {
                  <div class="form-group">
                    <label class="form-label">Hora de Apertura <span class="required">*</span></label>
                    <input type="time" class="form-input" formControlName="horaApertura">
                    @if (formularioHorario.get('horaApertura')?.touched &&
                    formularioHorario.get('horaApertura')?.invalid) {
                    <div class="error-message">Ingresa la hora de apertura</div>
                    }
                  </div>

                  <div class="form-group">
                    <label class="form-label">Hora de Cierre <span class="required">*</span></label>
                    <input type="time" class="form-input" formControlName="horaCierre">
                    @if (formularioHorario.get('horaCierre')?.touched && formularioHorario.get('horaCierre')?.invalid) {
                    <div class="error-message">Ingresa la hora de cierre</div>
                    }
                  </div>
                  }

                  <div class="form-actions">
                    <button type="submit" class="btn btn-primary" [disabled]="!formularioHorario.valid || guardando">
                      @if (!guardando) {
                      <span>Guardar</span>
                      } @else {
                      <span>Guardando...</span>
                      }
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>

          <!-- List Section -->
          <div class="list-section">
            <div class="list-header">
              <h2 class="list-title">Horarios Registrados</h2>
            </div>

            <!-- Loading State -->
            @if (cargando) {
            <div class="loading-state">
              <div class="spinner"></div>
              <p>Cargando horarios...</p>
            </div>
            }

            <!-- Empty State -->
            @if (!cargando && horarios.length === 0) {
            <div class="empty-state">
              <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <h3>No hay horarios configurados</h3>
              <p>Agrega tus horarios de trabajo</p>
            </div>
            }

            <!-- Items Grid -->
            @if (!cargando && horarios.length > 0) {
            <div class="items-grid">
              <div class="item-card" *ngFor="let horario of horarios">
                <div class="card-header">
                  <h3 class="card-title">{{ getNombreDia(horario.diaSemana) }}</h3>
                  <span class="status-badge" [ngClass]="!horario.activo ? 'status-descanso' : 'status-activo'">
                    {{ !horario.activo ? 'Descanso' : 'Activo' }}
                  </span>
                </div>
                <div class="card-body">
                  @if (horario.activo) {
                  <div class="card-detail">
                    <span class="detail-label">Apertura:</span>
                    <span class="detail-value">{{ formatearHora(horario.horaInicio) }}</span>
                  </div>
                  <div class="card-detail">
                    <span class="detail-label">Cierre:</span>
                    <span class="detail-value">{{ formatearHora(horario.horaFin) }}</span>
                  </div>
                  } @else {
                  <div class="card-detail">
                    <span class="detail-label">Estado:</span>
                    <span class="detail-value">D√≠a de Descanso</span>
                  </div>
                  }
                </div>
                <div class="card-actions">
                  <button class="action-btn" (click)="eliminarHorario(horario.idHorario)" title="Eliminar">
                    Eliminar
                  </button>
                </div>
              </div>
            </div>
            }
          </div>
        </div>
      </div>
      }

      <!-- Tab: Excepciones -->
      @if (tabActivo == 2) {
      <div class="tab-content">
        <div class="content-grid">
          <!-- Form Section -->
          <div class="form-section">
            <div class="form-container">
              <div class="form-header">
                <h2 class="form-title">Agregar Excepci√≥n</h2>
              </div>
              <div class="form-body">
                <form [formGroup]="formularioExcepcion" (ngSubmit)="guardarExcepcion()" class="form-content">
                  <div class="form-group">
                    <label class="form-label">Fecha <span class="required">*</span></label>
                    <input type="date" class="form-input" formControlName="fecha">
                    @if (formularioExcepcion.get('fecha')?.touched && formularioExcepcion.get('fecha')?.invalid) {
                    <div class="error-message">Selecciona una fecha</div>
                    }
                  </div>

                  <div class="form-group">
                    <label class="form-label">Hora de Inicio</label>
                    <input type="time" class="form-input" formControlName="horaInicio">
                    <small style="color: #b0b0b0; font-size: 0.85rem;">Opcional - Deja vac√≠o para todo el d√≠a</small>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Hora de Fin</label>
                    <input type="time" class="form-input" formControlName="horaFin">
                    <small style="color: #b0b0b0; font-size: 0.85rem;">Opcional - Deja vac√≠o para todo el d√≠a</small>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Motivo <span class="required">*</span></label>
                    <input type="text" class="form-input" formControlName="motivo"
                      placeholder="Ej: Cita m√©dica, Descanso, etc.">
                    @if (formularioExcepcion.get('motivo')?.touched && formularioExcepcion.get('motivo')?.invalid) {
                    <div class="error-message">Ingresa el motivo</div>
                    }
                  </div>

                  <div class="form-actions">
                    <button type="submit" class="btn btn-primary"
                      [disabled]="!formularioExcepcion.valid || guardandoExcepcion">
                      @if (!guardandoExcepcion) {
                      <span>‚úì Guardar</span>
                      } @else {
                      <span>Guardando...</span>
                      }
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>

          <!-- List Section -->
          <div class="list-section">
            <div class="list-header">
              <h2 class="list-title">Excepciones Registradas</h2>
            </div>

            <!-- Loading State -->
            @if (cargandoExcepciones) {
            <div class="loading-state">
              <div class="spinner"></div>
              <p>Cargando excepciones...</p>
            </div>
            }

            <!-- Empty State -->
            @if (!cargandoExcepciones && excepciones.length === 0) {
            <div class="empty-state">
              <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                </path>
              </svg>
              <h3>No hay excepciones registradas</h3>
              <p>Agrega excepciones para d√≠as especiales</p>
            </div>
            }

            <!-- Items Grid -->
            @if (!cargandoExcepciones && excepciones.length > 0) {
            <div class="items-grid">
              <div class="item-card" *ngFor="let excepcion of excepciones">
                <div class="card-header">
                  <h3 class="card-title">{{ excepcion.fechaInicio | date:'dd/MM/yyyy' }}</h3>
                  <span class="status-badge status-descanso">Excepci√≥n</span>
                </div>
                <div class="card-body">
                  @if (excepcion.horaInicio && !excepcion.todoElDia) {
                  <div class="card-detail">
                    <span class="detail-label">Hora:</span>
                    <span class="detail-value">{{ formatearHora(excepcion.horaInicio) }} - {{
                      formatearHora(excepcion.horaFin) }}</span>
                  </div>
                  } @else {
                  <div class="card-detail">
                    <span class="detail-label">Duraci√≥n:</span>
                    <span class="detail-value">Todo el d√≠a</span>
                  </div>
                  }
                  <div class="card-detail">
                    <span class="detail-label">Motivo:</span>
                    <span class="detail-value">{{ excepcion.motivo }}</span>
                  </div>
                </div>
                <div class="card-actions">
                  <button class="action-btn" (click)="eliminarExcepcion(excepcion.idExcepcion)" title="Eliminar">
                    üóëÔ∏è Eliminar
                  </button>
                </div>
              </div>
            </div>
            }
          </div>
        </div>
      </div>
      }
    </div>
  </section>
</div>